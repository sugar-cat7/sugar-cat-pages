# t_wada式 TDD 戦略

このドキュメントは、本テンプレートで t_wada ベースの TDD を実践するための最小ルールを定義する。

## 目的

- 変更に強いコードを小さなステップで育てる
- バグ修正時に再発防止テストを先に追加する
- 設計判断を実装後ではなくテスト作成時に引き出す

## 基本原則

- Red-Green-Refactor を短いサイクルで回す
- 1テストで1つの振る舞いだけを検証する
- 先にテストリストを作り、実装順を固定する
- Green では最小実装だけを入れ、一般化は後回しにする
- リファクタリングはテストが通っている状態でのみ行う

## 実装パターン

### 仮実装から始める

- 最初は定数返却などの仮実装で Green にする
- 次のケース追加で破綻を確認し、実装を育てる

### 三角測量で一般化する

- 2つ以上の具体例で同じ実装が通る形へ寄せる
- 早い段階で抽象化しすぎない

### 明白な実装を選ぶ

- 実装が十分に明らかな場合は直接本実装を書く
- ただしテストファーストは崩さない

## このプロジェクトでの適用順序

1. ユーティリティ関数・ヘルパー
2. UIコンポーネントのロジック
3. フィーチャーの統合テスト

`docs/web-frontend/unit-testing.md` のテーブルドリブンテストを基本形として利用する。

## 1ストーリーの進め方

1. テストリストから次の 1 項目を選ぶ
2. 失敗するテストを書く（Red）
3. 最小実装で通す（Green）
4. 重複除去と命名改善を行う（Refactor）
5. 必要なら次のケースを追加して三角測量する

## バグ修正フロー

1. バグを再現する失敗テストを先に追加する
2. そのテストだけを通す最小修正を入れる
3. 近傍ケースを追加し、退行リスクを下げる

## 運用チェックリスト

- テスト名は仕様を読める文章になっているか
- テストデータの重複を `it.each` で整理できているか
- 外部依存は境界でモックし、ドメインは実体で検証しているか
- リファクタリングで振る舞いを変えていないか

## 参考

- https://speakerdeck.com/twada/growing-reliable-code-php-conference-fukuoka-2025
