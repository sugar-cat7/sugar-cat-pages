name: PR Check
on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - uses: actions/checkout@v4

      - name: Set up pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10.28.0

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Build
        run: pnpm turbo build

  type-check:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - uses: actions/checkout@v4

      - name: Set up pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10.28.0

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Build packages
        run: |
          pnpm --filter @mypages/errors build
          pnpm --filter @mypages/dayjs build

      - name: Type Check
        run: pnpm turbo type-check

  biome-check:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - uses: actions/checkout@v4

      - name: Set up pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10.28.0

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Biome Check
        run: pnpm turbo biome:check

  # test:
  #   runs-on: ubuntu-latest
  #   timeout-minutes: 10
  #   steps:
  #     - uses: actions/checkout@v4

  #     - name: Set up pnpm
  #       uses: pnpm/action-setup@v4
  #       with:
  #         version: 10.24.0

  #     - name: Install dependencies
  #       run: pnpm install --frozen-lockfile

  #     - name: Build packages
  #       run: pnpm build

  #     - name: Run tests
  #       run: |
  #         pnpm --filter mypages test:coverage
  #         pnpm --filter @mypages/errors test:run
  #         pnpm --filter @mypages/logger test:run

  #     - name: Run octocov
  #       uses: k1LoW/octocov-action@v1
